# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура приложения

В приложении реализован функционал, благодаря которому пользователь имеет возможность оформить заказ:
выбрать товар, положить его в корзину, оплатить и ввести свои данные для доставки.
Процесс включает в себя: главный экран со списком карточек товара, попап карточки, попап корзины, попап форм и попап с информацией об успешном оформлении заказа.\
При проектировании архитектуры приложения был применен Событийно Ориентированный Подход (СОП).

Код приложения разделен на слои согласно парадигме MVP:
- слой данных, отвечает за хранение и изменение данных (**Model**),
- слой представления, отвечает за отображение данных на странице (**View**),
- презентер, отвечает за связь представления и данных (**Presenter**).


## Слой данных

#### Класс CatalogProductData
Описывает свойства каталога товаров

```
// Массив объектов карточек
_cards: ICard[];

// Id карточки товара, выбранной для просмотра в модальном окне
_preview: string | null;
```

#### Класс ProductData
Описывает свойства товара

```
// Id товара
id: string;

// Изображение товара
image: string;

// Название товара
title: string;

// Описание товара
description: string;

// Цена товара
price: number | null;

// Лейбл товара
label: string;
```

#### Класс BasketData
Описывает название товаров и их стоимость

```
// Название товара
title: string;

// Стоимость товара
price: number;
```

#### Класс OrderData
Описывает свойства заказа: данные пользователя, его адрес, номер телефона, электронную почту и способ оплаты заказа

```
// Список товаров в заказе
items: string[];

// Итоговая сумма к оплате
total: number;

// Способ оплаты
payment: PaymentMethod;

// Email пользователя
email: string;

// Телефон пользователя
phone: string;

// Адрес доставки
address: string;
```

#### Класс OrderConfirmData
Описывает подтверждение оформления заказа

```
// Итоговая сумма
total: number;
```


## Слой представления

#### Базовый класс Component
Работает с элементами DOM, в дженерик принимает тип объекта.
В конструктор принимает элемент разметки, который служит основой для компонента.
Содержит метод render, отвечающий за сохранение полученных в параметре данных в полях компонентов через их сеттеры, возвращает обновленный контейнер компонента.

#### Класс Page
Реализует отображение главного экрана

#### Класс CardsContainer
Реализует блок с карточками товара на главной странице.
В конструктор принимает контейнер, в котором размещаются карточки.
В метод render принимает массив элементов разметки карточек.

#### Класс Card
Реализует отображение карточки товара.
В конструктор принимает контейнер, в котором размещается карточка.

#### Класс CardBasket
Расширяет класс Card. Реализует отображение списка товаров в корзине: их название и стоимость.

#### Класс Modal
Реализует модальное окно.
Содержит методы `open` и `close` для управления отображением модального окна. Устанавливает слушатели на клавиатуру для закрытия модального окна по Esc, на клик в оверлей и кнопку закрытия.
- constructor(selector: string, events: IEvents)\
Конструктор принимает селектор, по которому в разметке страницы будет идентифицировано модальное окно и экземпляр класса `EventEmitter` для возможности инициации событий.

Поля класса
- modal: HTMLElement - элемент модального окна
- events: IEvents - брокер событий

#### Класс ModalForm
Расширяет класс Modal. Реализует валидацию форм.
Конструктор принимает обработчики событий для элементов формы и инициализирует элементы управления.

#### Класс ModalOrderForm
Расширяет класс Modal. Реализует способ оплаты, адрес доставки и контакты пользователя.

#### Класс ModalConfirm
Расширяет класс Modal. Реализует отображение данных об успешном оформлении заказа и его итоговую сумму.


## Слой коммуникации

#### Класс Api
В конструктор принимает базовый адрес сервера (baseUrl) и опции с заголовками запросов.
Методы:
- `get` выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер.
- `post` принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода.

#### Класс EventEmitter
Брокер, отвечающий за обработку событий.
Имплементируется интерфйесом `IEvents`:
- `on` подписка на событие
- `emit` инициализация события
- `trigger` возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие
